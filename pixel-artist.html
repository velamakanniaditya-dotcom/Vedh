<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pixel Artist ğŸ¨ - Creativity Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;800;900&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WORKSHEET THEME - CREATIVITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --primary: #ec4899; /* Bright Pink */
  --secondary: #8b5cf6; /* Purple */
  --danger: #ef4444; 
  --blue: #0ea5e9;
  --dark: #1e293b; 
  --paper: #ffffff;
  --grid: #fce7f3; /* Light pink grid */
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Nunito', sans-serif;
  background-color: #fdf2f8;
  background-image: radial-gradient(var(--grid) 3px, transparent 3px);
  background-size: 30px 30px; 
  color: var(--dark); min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
}

.home-btn {
  position: absolute; top: 20px; left: 20px; background: white; border: 3px solid var(--primary);
  color: var(--primary); padding: 8px 16px; border-radius: 50px; text-decoration: none;
  font-family: 'Fredoka One', cursive; font-size: 1.1rem; box-shadow: 0 4px 0 var(--primary); z-index: 100;
}
.home-btn:active { transform: translateY(4px); box-shadow: 0 0 0 var(--primary); }

header { text-align: center; margin-top: 40px; margin-bottom: 20px; }
h1 { font-family: 'Fredoka One', cursive; font-size: 3.5rem; color: var(--primary); text-shadow: 2px 2px 0 #fff; line-height: 1; }
.subtitle { font-size: 1.2rem; font-weight: 800; color: #475569; margin-top: 5px; }

.screen { display: none; width: 100%; max-width: 600px; animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
.screen.active { display: block; }
@keyframes popIn { 0% { opacity: 0; transform: scale(0.9) translateY(20px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }

.worksheet-card { background: var(--paper); border: 4px solid var(--dark); border-radius: 24px; padding: 30px; box-shadow: 0 10px 0 rgba(30, 41, 59, 0.1); text-align: center; position: relative; }

/* Modes */
.mode-btn { width: 100%; display: flex; align-items: center; gap: 15px; background: white; border: 4px solid var(--dark); border-radius: 20px; padding: 15px 20px; margin-bottom: 15px; cursor: pointer; text-align: left; box-shadow: 0 6px 0 var(--dark); transition: all 0.1s; }
.mode-btn:active { transform: translateY(6px); box-shadow: 0 0 0 var(--dark); }
.mode-icon { font-size: 2.5rem; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.1)); }

/* Game Area */
.top-bar { display: flex; justify-content: space-between; align-items: center; font-family: 'Fredoka One', cursive; font-size: 1.5rem; margin-bottom: 15px; color: var(--dark); }

/* Pixel Canvas */
.canvas-container {
  display: flex; justify-content: center; margin-bottom: 20px;
  touch-action: none; /* Prevents iPad scrolling when drawing */
}
.pixel-canvas {
  display: grid;
  grid-template-columns: repeat(16, 1fr);
  width: 100%; max-width: 320px;
  background: white;
  border: 4px solid var(--dark);
  box-shadow: 0 8px 0 rgba(0,0,0,0.1);
  border-radius: 8px;
  overflow: hidden;
}
.pixel-cell {
  aspect-ratio: 1 / 1;
  background-color: white;
  border: 1px solid #f1f5f9;
  cursor: crosshair;
}
/* Faint outline for coloring book mode */
.pixel-outline { background-color: #cbd5e1; }

/* Tools & Palette */
.tools-container { display: flex; flex-direction: column; gap: 15px; }
.palette { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; background: #f8fafc; padding: 15px; border-radius: 16px; border: 3px dashed #cbd5e1; }
.color-swatch {
  width: 40px; height: 40px; border-radius: 50%;
  border: 3px solid rgba(0,0,0,0.2); cursor: pointer;
  transition: transform 0.1s; box-shadow: 0 3px 0 rgba(0,0,0,0.1);
}
.color-swatch.active { transform: scale(1.2); border-color: var(--dark); }

.action-row { display: flex; gap: 10px; justify-content: center; }
.tool-btn { flex: 1; font-family: 'Fredoka One', cursive; font-size: 1.2rem; background: white; color: var(--dark); border: 4px solid var(--dark); border-radius: 12px; padding: 10px; cursor: pointer; box-shadow: 0 4px 0 var(--dark); }
.tool-btn:active { transform: translateY(4px); box-shadow: 0 0 0 var(--dark); }
.tool-btn.active { background: var(--dark); color: white; }

.btn-primary { width: 100%; font-family: 'Fredoka One', cursive; font-size: 1.5rem; background: var(--primary); color: white; border: 4px solid #be185d; border-radius: 16px; padding: 15px; cursor: pointer; box-shadow: 0 6px 0 #be185d; margin-top: 15px;}
.btn-primary:active { transform: translateY(6px); box-shadow: 0 0 0 #be185d; }

@media(max-width: 500px) {
  .color-swatch { width: 35px; height: 35px; }
  .tool-btn { font-size: 1rem; }
}
</style>
</head>
<body>

<a href="index.html" class="home-btn">ğŸ  Home</a>

<header>
  <h1>Pixel Artist</h1>
  <div class="subtitle">Creativity Lab ğŸ¨</div>
</header>

<div id="modeScreen" class="screen active">
  <div class="worksheet-card">
    <h2 style="font-family:'Fredoka One'; font-size: 1.8rem; margin-bottom: 20px; color: var(--dark);">What shall we draw?</h2>
    
    <button class="mode-btn" style="border-color: var(--primary); box-shadow: 0 6px 0 var(--primary);" onclick="startGame('free')">
      <div class="mode-icon">ğŸ–Œï¸</div>
      <div>
        <h3 style="font-family:'Fredoka One'; font-size: 1.4rem; color: var(--dark);">Free Draw</h3>
        <p style="font-weight: 600; color: #64748b;">A blank canvas for your imagination!</p>
      </div>
    </button>

    <button class="mode-btn" style="border-color: var(--danger); box-shadow: 0 6px 0 var(--danger);" onclick="startGame('heart')">
      <div class="mode-icon">â¤ï¸</div>
      <div>
        <h3 style="font-family:'Fredoka One'; font-size: 1.4rem; color: var(--dark);">Color a Heart</h3>
        <p style="font-weight: 600; color: #64748b;">Color in the shape of a heart.</p>
      </div>
    </button>

    <button class="mode-btn" style="border-color: var(--secondary); box-shadow: 0 6px 0 var(--secondary);" onclick="startGame('sword')">
      <div class="mode-icon">ğŸ—¡ï¸</div>
      <div>
        <h3 style="font-family:'Fredoka One'; font-size: 1.4rem; color: var(--dark);">Color a Sword</h3>
        <p style="font-weight: 600; color: #64748b;">Color an epic hero's pixel sword.</p>
      </div>
    </button>
  </div>
</div>

<div id="gameScreen" class="screen">
  <div class="worksheet-card">
    <div class="top-bar">
      <button style="background:none; border:none; color:#64748b; font-family:'Fredoka One'; font-size:1.2rem; cursor:pointer;" onclick="switchScreen('modeScreen')">ğŸ”™ Back</button>
      <div id="modeDisplay" style="color: var(--primary);">ğŸ–Œï¸ Studio</div>
    </div>

    <div class="canvas-container">
      <div class="pixel-canvas" id="canvas"></div>
    </div>

    <div class="tools-container">
      <div class="palette" id="palette">
        <div class="color-swatch active" style="background: #000000;" onclick="setColor('#000000', this)"></div>
        <div class="color-swatch" style="background: #ef4444;" onclick="setColor('#ef4444', this)"></div>
        <div class="color-swatch" style="background: #f97316;" onclick="setColor('#f97316', this)"></div>
        <div class="color-swatch" style="background: #eab308;" onclick="setColor('#eab308', this)"></div>
        <div class="color-swatch" style="background: #22c55e;" onclick="setColor('#22c55e', this)"></div>
        <div class="color-swatch" style="background: #06b6d4;" onclick="setColor('#06b6d4', this)"></div>
        <div class="color-swatch" style="background: #3b82f6;" onclick="setColor('#3b82f6', this)"></div>
        <div class="color-swatch" style="background: #a855f7;" onclick="setColor('#a855f7', this)"></div>
        <div class="color-swatch" style="background: #ec4899;" onclick="setColor('#ec4899', this)"></div>
        <div class="color-swatch" style="background: #8b5cf6;" onclick="setColor('#8b5cf6', this)"></div>
        <div class="color-swatch" style="background: #84cc16;" onclick="setColor('#84cc16', this)"></div>
        <div class="color-swatch" style="background: #ffffff;" onclick="setColor('#ffffff', this)"></div>
      </div>
      
      <div class="action-row">
        <button class="tool-btn active" id="btnDraw" onclick="setTool('draw')">ğŸ–Œï¸ Draw</button>
        <button class="tool-btn" id="btnErase" onclick="setTool('erase')">ğŸ§¹ Erase</button>
        <button class="tool-btn" onclick="clearCanvas()">ğŸ—‘ï¸ Clear</button>
      </div>

      <button class="btn-primary" onclick="endGame()">Save Masterpiece (+15 XP) âœ¨</button>
    </div>
  </div>
</div>

<div id="endScreen" class="screen">
  <div class="worksheet-card">
    <h2 style="font-family:'Fredoka One'; font-size: 2.5rem; color: var(--dark);">Masterpiece Saved!</h2>
    <div style="font-size: 5rem; margin: 10px 0; animation: popIn 0.5s ease;">ğŸ–¼ï¸</div>
    <div style="font-size: 1.2rem; font-weight: 800; color: #64748b; margin-bottom: 25px;">You earned +15 XP!</div>
    <button class="btn-primary" onclick="switchScreen('modeScreen')">Draw Something Else ğŸ¨</button>
  </div>
</div>

<script>
// --- TEMPLATES (16x16 Grid) ---
// 'X' represents the outline to color, '.' is blank
const TEMPLATES = {
  heart: [
    "................",
    "................",
    "...XXXX..XXXX...",
    "..X....XX....X..",
    ".X............X.",
    ".X............X.",
    "..X..........X..",
    "...X........X...",
    "....X......X....",
    ".....X....X.....",
    "......X..X......",
    ".......XX.......",
    "................",
    "................",
    "................",
    "................"
  ],
  sword: [
    "...............X",
    "..............XX",
    ".............XX.",
    "............XX..",
    "...........XX...",
    "..........XX....",
    ".........XX.....",
    "........XX......",
    "...X...XX.......",
    "..XXX.XX........",
    "...XXX..........",
    "..X.XXX.........",
    ".X...X.X........",
    "X.......X.......",
    "................",
    "................"
  ]
};

// --- GAME STATE ---
const GRID_SIZE = 16;
let currentColor = '#000000';
let currentTool = 'draw';
let isDrawing = false;
let currentMode = 'free';

const screens = {
  modeScreen: document.getElementById('modeScreen'),
  gameScreen: document.getElementById('gameScreen'),
  endScreen: document.getElementById('endScreen')
};
const canvas = document.getElementById('canvas');

function switchScreen(screenName) {
  Object.values(screens).forEach(s => s.classList.remove('active'));
  screens[screenName].classList.add('active');
}

function startGame(mode) {
  currentMode = mode;
  createCanvas();
  switchScreen('gameScreen');
}

function setColor(color, element) {
  currentColor = color;
  currentTool = 'draw';
  document.getElementById('btnDraw').classList.add('active');
  document.getElementById('btnErase').classList.remove('active');
  
  // Update active swatch
  document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
  element.classList.add('active');
}

function setTool(tool) {
  currentTool = tool;
  document.getElementById('btnDraw').classList.remove('active');
  document.getElementById('btnErase').classList.remove('active');
  
  if(tool === 'draw') {
    document.getElementById('btnDraw').classList.add('active');
    if(currentColor === '#ffffff') currentColor = '#000000'; // Default to black if coming from eraser and it was white
  } else {
    document.getElementById('btnErase').classList.add('active');
  }
}

function clearCanvas() {
  createCanvas();
}

function createCanvas() {
  canvas.innerHTML = '';
  let template = currentMode !== 'free' ? TEMPLATES[currentMode] : null;

  for (let y = 0; y < GRID_SIZE; y++) {
    for (let x = 0; x < GRID_SIZE; x++) {
      const cell = document.createElement('div');
      cell.className = 'pixel-cell';
      cell.dataset.x = x;
      cell.dataset.y = y;

      // Apply template outline if not free draw
      if (template && template[y][x] === 'X') {
        cell.classList.add('pixel-outline');
      }

      // Mouse Events (PC)
      cell.addEventListener('mousedown', (e) => {
        isDrawing = true;
        paintCell(e.target);
      });
      cell.addEventListener('mouseover', (e) => {
        if (isDrawing) paintCell(e.target);
      });

      canvas.appendChild(cell);
    }
  }

  // Stop drawing when mouse goes up anywhere on screen
  document.addEventListener('mouseup', () => isDrawing = false);
}

// Touch Events (iPad/Mobile Support)
canvas.addEventListener('touchstart', (e) => {
  e.preventDefault(); // Stop scrolling
  isDrawing = true;
  let touch = e.touches[0];
  let cell = document.elementFromPoint(touch.clientX, touch.clientY);
  if (cell && cell.classList.contains('pixel-cell')) paintCell(cell);
}, { passive: false });

canvas.addEventListener('touchmove', (e) => {
  e.preventDefault();
  if (!isDrawing) return;
  let touch = e.touches[0];
  let cell = document.elementFromPoint(touch.clientX, touch.clientY);
  if (cell && cell.classList.contains('pixel-cell')) paintCell(cell);
}, { passive: false });

canvas.addEventListener('touchend', () => isDrawing = false);
canvas.addEventListener('touchcancel', () => isDrawing = false);

function paintCell(cell) {
  if (currentTool === 'draw') {
    cell.style.backgroundColor = currentColor;
    cell.classList.remove('pixel-outline'); // Remove outline if painted over
  } else if (currentTool === 'erase') {
    cell.style.backgroundColor = 'white';
    // If it was a template outline, bring the outline back
    let template = currentMode !== 'free' ? TEMPLATES[currentMode] : null;
    let x = cell.dataset.x;
    let y = cell.dataset.y;
    if (template && template[y][x] === 'X') {
      cell.classList.add('pixel-outline');
    }
  }
}

function endGame() {
  // --- XP SYSTEM INTEGRATION ---
  let currentXP = parseInt(localStorage.getItem('vedhTotalXP')) || 0;
  localStorage.setItem('vedhTotalXP', currentXP + 15); // +15 XP for finishing art
  
  switchScreen('endScreen');
}
</script>
</body>
</html>
